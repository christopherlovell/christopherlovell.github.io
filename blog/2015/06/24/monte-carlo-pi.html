<!DOCTYPE html>
<html lang="en">
  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <!-- Metadata, OpenGraph and Schema.org -->




<!-- Standard metadata -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>
  
  
    
      Using Monte Carlo methods to estimate pi | Chris Lovell
    
  
</title>
<meta name="author" content="Chris Lovell">
<meta name="description" content="Computational Astrophysicist
">










<!-- Bootstrap & MDB -->
<link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

<!-- Bootstrap Table -->


<!-- Fonts & Icons -->
<link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5">
<link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap">

<!-- Code Syntax Highlighting -->
<link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light">



<!-- Styles -->

<!-- pseudocode -->



  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A6%86&lt;/text&gt;&lt;/svg&gt;">

<link rel="stylesheet" href="/assets/css/main.css?896d742183f0378203f61ae2e63e7f8b">
<link rel="canonical" href="https://christopherlovell.co.uk/blog/2015/06/24/monte-carlo-pi.html">

<!-- Dark Mode -->
<script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script>


<!-- GeoJSON support via Leaflet -->


<!-- diff2html -->






  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">
    <!-- Header -->
    <header>
  <!-- Nav Bar -->
  <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation">
    <div class="container">
      
        <a class="navbar-brand title font-weight-lighter" href="/">
          
            
              <span class="font-weight-bold">Chris</span>
            
            
            Lovell
          
        </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>

      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          

          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">about
              
            </a>
          </li>

          <!-- Other pages -->
          
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
              
                
                <li class="nav-item ">
                  
                  <a class="nav-link" href="/publications/">publications
                    
                  </a>
                </li>
              
            
          
            
              
                
                <li class="nav-item ">
                  
                  <a class="nav-link" href="/projects/">projects
                    
                  </a>
                </li>
              
            
          
            
              
                
                <li class="nav-item ">
                  
                  <a class="nav-link" href="/collaborations/">collaborations
                    
                  </a>
                </li>
              
            
          
            
              
                
                <li class="nav-item ">
                  
                  <a class="nav-link" href="/meetings/">meetings
                    
                  </a>
                </li>
              
            
          
            
              
                
                <li class="nav-item ">
                  
                  <a class="nav-link" href="/codes/">codes
                    
                  </a>
                </li>
              
            
          
            
          
            
          
            
          
        </ul>
      </div>
    </div>
  </nav>
  
    <!-- Scrolling Progress Bar -->
    <progress id="progress" value="0">
      <div class="progress-container">
        <span class="progress-bar"></span>
      </div>
    </progress>
  
</header>


    <!-- Content -->
    <div class="container mt-5" role="main">
      
        







<div class="post">
  <header class="post-header">
    <h1 class="post-title">Using Monte Carlo methods to estimate pi</h1>
    <p class="post-meta">
      Created in June 24, 2015
      
      
      
    </p>
    <p class="post-tags">
      
        <a href="/blog/2015"> <i class="fa-solid fa-calendar fa-sm"></i> 2015 </a>
      
      
          ·  
        
          
            <a href="/blog/tag/data-science"> <i class="fa-solid fa-hashtag fa-sm"></i> Data Science</a>
          
          
        
      

      
    </p>
  </header>

  <article class="post-content">
    
    <div id="markdown-content">
      <p>You’ve just bought a brand new computer. You excitedly rip open the packaging, carefully extract it from the box, remove the protective film from the screen (so satisfying) and, after 10 hours of charging, boot it up. It turns on fine, and everything seems to be functioning normally. It’s only after a few minutes of use that you discover, to your horror, that the manufacturer has forgotten to store the constant $\pi$ on the operating system. How are you going to play <a href="https://kerbalspaceprogram.com/en/" rel="external nofollow noopener" target="_blank">Kerbal space program</a> if you can’t calculate the equations of motion of your rockets and space probes?!</p>

<p>One way around this is to use Monte Carlo methods, taking advantage of the law of large numbers to gain a reasonable approximation of pi to a few decimal places. In this post I’ll demonstrate this using Julia (we’ll conveniently ignore the fact that Julia has the number $\pi$ in it), which I’ve just started learning and having a play with.</p>

<p>Take a square of side $a$, centred on the origin. Now place a circle inside the box with radius $a/2$, also centred on the origin. The area of the rectangle is $a^2$, and the area of the circle is $\pi(a/2)^2$.</p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="k">using</span> <span class="n">DataArrays</span><span class="x">,</span> <span class="n">DataFrames</span>
<span class="k">using</span> <span class="n">Gadfly</span>
<span class="k">using</span> <span class="n">Compose</span>

<span class="n">set_default_plot_size</span><span class="x">(</span><span class="mi">10</span><span class="n">cm</span><span class="x">,</span><span class="mi">10</span><span class="n">cm</span><span class="x">)</span>

<span class="n">compose</span><span class="x">(</span><span class="n">context</span><span class="x">(),</span>
  <span class="x">(</span><span class="n">context</span><span class="x">(),</span><span class="n">circle</span><span class="x">(</span><span class="mf">0.5</span><span class="x">,</span><span class="o">.</span><span class="mi">5</span><span class="x">,</span><span class="mf">0.5</span><span class="x">),</span><span class="n">fill</span><span class="x">(</span><span class="s">"tomato"</span><span class="x">)),</span>
  <span class="x">(</span><span class="n">context</span><span class="x">(),</span><span class="n">rectangle</span><span class="x">(</span><span class="mf">0.</span><span class="x">,</span><span class="mf">0.</span><span class="x">,</span><span class="mi">1</span><span class="x">,</span><span class="mi">1</span><span class="x">),</span><span class="n">fill</span><span class="x">(</span><span class="s">"black"</span><span class="x">))</span>
<span class="x">)</span></code></pre></figure>

<p><br></p>

<p><a href="/assets/monte-carlo-pi/output_1_0.svg" data-lightbox="Circle in rectangle" data-title="Circle in rectangle">
  <img class="small" src="/assets/monte-carlo-pi/output_1_0.svg" title="Circle in rectangle">
</a></p>

<p><br></p>

<p>If we take any random point within the rectangle, then the probability that this point lies within the circle, $P(circle)$, is equal to the area of the circle relative to the area of the rectangle. i.e,</p>

\[P(circle)=\frac{A\_{circle}}{A\_{square}}=\frac{\pi (a/2)^2}{a^2}\]

<p>If we take $n$ points, then as $n$ gets very large the fraction of points that lie within the circle will converge to the probability of landing in the circle, $P(circle)$.</p>

<p>Expanding and rearranging our equation above for $\pi$,</p>

\[\pi = 4\times P(circle)\]

<p>Below is a Julia script for doing just this. $n$ samples from a bivariate uniform range $[0,1]$ are taken, and used as coordinates $(x,y)$ centred on the origin. For each coordinate a distance from the origin is calculated; if this exceeds the radius of the circle then it must lie outside, if not the point is within the circle. The sum of points in the circle is divided by the total number of points taken to give the probability of points in the circle. We can then use the equation above to estimate $\pi$.</p>

<p>The plot shows a sample of the coordinates generated, coloured by whether they lie in or out of the circle.</p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">n</span> <span class="o">=</span> <span class="mi">1000000</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="x">()</span>
<span class="n">df</span><span class="x">[</span><span class="o">:</span><span class="n">x</span><span class="x">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">rand</span><span class="x">(</span><span class="n">n</span><span class="x">)</span>
<span class="n">df</span><span class="x">[</span><span class="o">:</span><span class="n">y</span><span class="x">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">rand</span><span class="x">(</span><span class="n">n</span><span class="x">)</span>
<span class="n">df</span><span class="x">[</span><span class="o">:</span><span class="n">c</span><span class="x">]</span> <span class="o">=</span> <span class="kt">Array</span><span class="x">(</span><span class="kt">String</span><span class="x">,</span> <span class="n">n</span><span class="x">)</span>
<span class="n">df</span><span class="x">[</span><span class="o">:</span><span class="n">r</span><span class="x">]</span> <span class="o">=</span> <span class="kt">Array</span><span class="x">(</span><span class="kt">Float64</span><span class="x">,</span> <span class="n">n</span><span class="x">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="n">n</span>
    <span class="n">df</span><span class="x">[</span><span class="n">i</span><span class="x">,</span><span class="o">:</span><span class="n">r</span><span class="x">]</span> <span class="o">=</span> <span class="x">(</span><span class="n">df</span><span class="x">[</span><span class="n">i</span><span class="x">,</span><span class="o">:</span><span class="n">x</span><span class="x">]</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">df</span><span class="x">[</span><span class="n">i</span><span class="x">,</span><span class="o">:</span><span class="n">y</span><span class="x">]</span><span class="o">^</span><span class="mi">2</span><span class="x">)</span><span class="o">^.</span><span class="mi">5</span>
    <span class="k">if</span> <span class="n">df</span><span class="x">[</span><span class="n">i</span><span class="x">,</span><span class="o">:</span><span class="n">r</span><span class="x">]</span> <span class="o">&lt;</span> <span class="mf">0.5</span>
        <span class="n">df</span><span class="x">[</span><span class="n">i</span><span class="x">,</span><span class="o">:</span><span class="n">c</span><span class="x">]</span> <span class="o">=</span> <span class="s">"in"</span>
    <span class="k">else</span>
        <span class="n">df</span><span class="x">[</span><span class="n">i</span><span class="x">,</span><span class="o">:</span><span class="n">c</span><span class="x">]</span> <span class="o">=</span> <span class="s">"out"</span>
    <span class="k">end</span>
<span class="k">end</span>

<span class="n">circle_df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="x">()</span>
<span class="n">circle_df</span><span class="x">[</span><span class="o">:</span><span class="n">c</span><span class="x">]</span> <span class="o">=</span> <span class="n">cos</span><span class="x">(</span><span class="o">-</span><span class="nb">pi</span><span class="o">:</span><span class="mf">0.01</span><span class="o">:</span><span class="nb">pi</span><span class="x">)</span><span class="o">/</span><span class="mi">2</span>
<span class="n">circle_df</span><span class="x">[</span><span class="o">:</span><span class="n">s</span><span class="x">]</span> <span class="o">=</span> <span class="n">sin</span><span class="x">(</span><span class="o">-</span><span class="nb">pi</span><span class="o">:</span><span class="mf">0.01</span><span class="o">:</span><span class="nb">pi</span><span class="x">)</span><span class="o">/</span><span class="mi">2</span>

<span class="n">set_default_plot_size</span><span class="x">(</span><span class="mi">15</span><span class="n">cm</span><span class="x">,</span><span class="mi">15</span><span class="n">cm</span><span class="x">)</span>

<span class="n">plot</span><span class="x">(</span><span class="n">df</span><span class="x">[</span><span class="n">sample</span><span class="x">(</span><span class="mi">1</span><span class="o">:</span><span class="n">size</span><span class="x">(</span><span class="n">df</span><span class="x">,</span> <span class="mi">1</span><span class="x">),</span> <span class="n">iceil</span><span class="x">(</span><span class="mf">0.001</span> <span class="o">*</span> <span class="n">size</span><span class="x">(</span><span class="n">df</span><span class="x">,</span> <span class="mi">1</span><span class="x">))),</span> <span class="o">:</span><span class="x">],</span> <span class="n">x</span><span class="o">=</span><span class="s">"x"</span><span class="x">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"y"</span><span class="x">,</span> <span class="n">color</span><span class="o">=</span><span class="s">"c"</span><span class="x">,</span> <span class="n">Geom</span><span class="o">.</span><span class="n">point</span><span class="x">,</span><span class="n">Coord</span><span class="o">.</span><span class="n">cartesian</span><span class="x">(</span><span class="n">fixed</span><span class="o">=</span><span class="nb">true</span><span class="x">),</span>
<span class="n">Guide</span><span class="o">.</span><span class="n">Annotation</span><span class="x">(</span><span class="n">compose</span><span class="x">(</span><span class="n">context</span><span class="x">(),</span><span class="n">circle</span><span class="x">(</span><span class="mi">0</span><span class="x">,</span><span class="mi">0</span><span class="x">,</span><span class="mf">0.5</span><span class="x">),</span> <span class="n">fill</span><span class="x">(</span><span class="nb">nothing</span><span class="x">),</span> <span class="n">stroke</span><span class="x">(</span><span class="s">"orange"</span><span class="x">))))</span></code></pre></figure>

<p><a href="/assets/monte-carlo-pi/output_3_0.svg" data-lightbox="Point distribution" data-title="Point distribution">
  <img class="small" src="/assets/monte-carlo-pi/output_3_0.svg" title="Point distribution">
</a></p>

<figure class="highlight"><pre><code class="language-julia" data-lang="julia"><span class="n">print</span><span class="x">(</span><span class="s">"pi ~ "</span><span class="x">,</span><span class="mi">4</span><span class="o">*</span><span class="n">sum</span><span class="x">(</span><span class="n">df</span><span class="x">[</span><span class="o">:</span><span class="n">c</span><span class="x">]</span> <span class="o">.==</span> <span class="s">"in"</span><span class="x">)</span><span class="o">/</span><span class="n">n</span><span class="x">)</span>
<span class="nb">pi</span> <span class="o">~</span> <span class="mf">3.138924</span></code></pre></figure>


    </div>
  </article>

  

  
    
      

  
    
    <br>
    <hr>
    <br>
    <ul class="list-disc pl-8"></ul>

    <!-- Adds related posts to the end of an article -->
    <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2>
    <p class="mb-2">Here are some more articles you might like to read next:</p>
  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2019/10/30/sphinx-documentation.html">An introduction to creating Python documentation using Sphinx</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2017/09/03/mondrian-generator.html">D3 Mondrian Generator</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2017/03/04/ssh-jupyter.html">Accessing Jupyter over SSH</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2016/08/19/spotmybackup.html">Back up your Spotify Playlists</a>
  </li>

  

  <li class="my-2">
    <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2016/08/16/convert-wav-mp3.html">Converting WAV to MP3 in the terminal</a>
  </li>



    
  

  
  
</div>

      
    </div>

    <!-- Footer -->
    
  <footer class="fixed-bottom" role="contentinfo">
    <div class="container mt-0">
      © Copyright 2026
      Chris
      
      Lovell. 
      
      
    </div>
  </footer>



    <!-- JavaScripts -->
    <!-- jQuery -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
<script src="/assets/js/bootstrap.bundle.min.js"></script>
<!-- <script src="/assets/js/mdb.min.js"></script> -->
<script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    
  <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>


    

    

    

    

    

    

    

    

    

  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script>



<!-- Bootstrap Table -->


<!-- Load Common JS -->
<script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script>
<script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script>
<script defer src="/assets/js/starfield.js?78ede5cffd95a17283a64e12d45bb7cc"></script>
<script defer src="/assets/js/summary_accordion.js?be8528c654eb46d4c9099f11271def29"></script>
<script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script>


<!-- Jupyter Open External Links New Tab -->
<script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script>



    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>


  <script async src="https://badge.dimensions.ai/badge.js"></script>


    
  
    <!-- MathJax -->
    <script type="text/javascript">
      window.MathJax = {
        tex: {
          tags: 'ams',
        },
      };
    </script>
    <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script>
    <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script>
  


    

    




    
  <!-- Scrolling Progress Bar -->
  <script type="text/javascript">
    /*
     * This JavaScript code has been adapted from the article
     * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar,
     * published on the website https://css-tricks.com on the 7th of May, 2014.
     * Couple of changes were made to the original code to make it compatible
     * with the `al-foio` theme.
     */
    const progressBar = $('#progress');
    /*
     * We set up the bar after all elements are done loading.
     * In some cases, if the images in the page are larger than the intended
     * size they'll have on the page, they'll be resized via CSS to accomodate
     * the desired size. This mistake, however, breaks the computations as the
     * scroll size is computed as soon as the elements finish loading.
     * To account for this, a minimal delay was introduced before computing the
     * values.
     */
    window.onload = function () {
      setTimeout(progressBarSetup, 50);
    };
    /*
     * We set up the bar according to the browser.
     * If the browser supports the progress element we use that.
     * Otherwise, we resize the bar thru CSS styling
     */
    function progressBarSetup() {
      if ('max' in document.createElement('progress')) {
        initializeProgressElement();
        $(document).on('scroll', function () {
          progressBar.attr({ value: getCurrentScrollPosition() });
        });
        $(window).on('resize', initializeProgressElement);
      } else {
        resizeProgressBar();
        $(document).on('scroll', resizeProgressBar);
        $(window).on('resize', resizeProgressBar);
      }
    }
    /*
     * The vertical scroll position is the same as the number of pixels that
     * are hidden from view above the scrollable area. Thus, a value > 0 is
     * how much the user has scrolled from the top
     */
    function getCurrentScrollPosition() {
      return $(window).scrollTop();
    }

    function initializeProgressElement() {
      let navbarHeight = $('#navbar').outerHeight(true);
      $('body').css({ 'padding-top': navbarHeight });
      $('progress-container').css({ 'padding-top': navbarHeight });
      progressBar.css({ top: navbarHeight });
      progressBar.attr({
        max: getDistanceToScroll(),
        value: getCurrentScrollPosition(),
      });
    }
    /*
     * The offset between the html document height and the browser viewport
     * height will be greater than zero if vertical scroll is possible.
     * This is the distance the user can scroll
     */
    function getDistanceToScroll() {
      return $(document).height() - $(window).height();
    }

    function resizeProgressBar() {
      progressBar.css({ width: getWidthPercentage() + '%' });
    }
    // The scroll ratio equals the percentage to resize the bar
    function getWidthPercentage() {
      return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
    }
  </script>


    

    

    

    
  <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script>
  <script>
    addBackToTop();
  </script>


    

  </body>
</html>
